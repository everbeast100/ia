DD Lab Program No.5:


  5. Create a table Sales Details with columns SNO, MONTH, TARGET and
     QTY_SOLD to store the Sales Details of one year. Specify the composite
     primary key to the columns SNO and MONTH. TARGET and SALES must
     be positive numbers.
     Write the following SQL queries:
      a) Display the total sales by each sales person considering only those
         monthâ€™s sales where target was reached.
        SELECT SNO, SUM(QTY_SOLD) AS Total_Sales
        FROM Sales_Details
        WHERE QTY_SOLD >= TARGET
        GROUP BY SNO;


      b) If a commission of RS.50 provided for each item after reaching target
         calculate and display the total commission for each sales person.
        SELECT SNO, SUM(CASE WHEN QTY_SOLD >= TARGET                    THEN
        (QTY_SOLD - TARGET) * 50 ELSE 0 END) AS Total_Commission
        FROM Sales_Details
        GROUP BY SNO;


      c) Display the SNO of those who never reached the target.
        SELECT DISTINCT SNO
        FROM Sales_Details
        WHERE SNO NOT IN (
                SELECT SNO FROM Sales_Details
                WHERE QTY_SOLD >= TARGET );


      d) Display sales records where the target was exceeded.
        SELECT * FROM Sales_Details
        WHERE QTY_SOLD > TARGET;


      e) Display the SNO, MONTH and QTY_SOLD of the sales persons with SNO
         S0001 or S0003.
        SELECT SNO, MONTH, QTY_SOLD
        FROM Sales_Details
        WHERE SNO IN ('S0001', 'S0003');
f) Display the month with the top 2 highest sales.
  SELECT MONTH, SUM(QTY_SOLD) AS Total_Sales
   FROM Sales_Details
   GROUP BY MONTH
   ORDER BY Total_Sales DESC
   LIMIT 2;


g) Display the salesperson(s) other than top 2 highest total sales
  SELECT SNO, SUM(QTY_SOLD) AS Total_Sales
  FROM Sales_Details
  GROUP BY SNO
  ORDER BY Total_Sales DESC
  OFFSET 2;
