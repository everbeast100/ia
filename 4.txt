DD Lab Program 4 Solution:
Create a table SALES with column SNO, SNAME, MANAGER_NAME, JOIN_DATE, DATE_BIRTH, SALARY,
SALES_AMOUNT and COMMISSION. Minimum age for joining the company must be 18 yrs. Default
value for commission should be 0. Apply the suitable structure for the columns. Specify primary key
and NOT NULL constraints on the table. Insert 10 records with data except commission. Manager of
Manager can be Null.


CREATE TABLE SALES (
     SNO VARCHAR(10) PRIMARY KEY,
     SNAME VARCHAR(50) NOT NULL,
     MANAGER_NAME VARCHAR(50),
     JOIN_DATE DATE NOT NULL,
 DATE_BIRTH DATE CHECK(DATE_BIRTH<= DATE_SUB(SYSDATE(), INTERVAL 18 YEAR)),
     SALARY DECIMAL(10, 2) NOT NULL,
     SALES_AMOUNT DECIMAL(10, 2),
     COMMISSION DECIMAL(5, 2) DEFAULT 0.0
);




Write the following SQL queries:

a) Retrieve the names of the employees who joined the company after a certain date ’15-02-2020’.
SELECT SNAME
FROM SALES
WHERE JOIN_DATE > '2020-02-15';



b) Retrieve the total sales amount for all salesmen.
SELECT SUM(SALES_AMOUNT) AS Total_Sales_Amount
FROM SALES
WHERE SALES_AMOUNT IS NOT NULL;
c) Retrieve the names of employees whose manager's name is NULL.
SELECT SNAME
FROM SALES
WHERE MANAGER_NAME IS NULL;



d) Retrieve the oldest employee (based on date of birth).
SELECT SNAME, DATE_BIRTH
FROM SALES
ORDER BY DATE_BIRTH
LIMIT 1;



e) Retrieve the names salesmen who have not made any sales (sales amount is 0)
SELECT SNAME
FROM SALES
WHERE SALES_AMOUNT = 0;



f) Retrieve the details of employee who are older than 30 years.
  SELECT * FROM SALES
WHERE DATE_BIRTH <= DATE_SUB(SYSDATE(), INTERVAL 30 YEAR);




g) Display the details of Sales Persons whose salary is more than average salary in the company.
SELECT * FROM SALES
WHERE SALARY > (SELECT AVG(SALARY) FROM SALES);




h) Update commission as 20% of Sales Amount.
UPDATE SALES
SET COMMISSION = 0.20 * SALES_AMOUNT;
i) Display SNO, SNAME, MANAGER_NAME, SALARY, COMMISSION, MANAGER_SALARY of the sales
   persons getting sum of salary and commission more than salary of manager. (Self join)


SELECT s1.SNO, s1.SNAME, s1.MANAGER_NAME, s1.SALARY, s1.COMMISSION,
s2.SNAME, s2.SALARY AS MANAGER_SALARY
FROM SALES s1
INNER JOIN SALES s2 ON
s1.SNAME = s2.SNAME
WHERE (s1.SALARY + s1.COMMISSION) > s2.SALARY;




j) Display the records of employees who finished the service of 10 years.
SELECT * FROM SALES
WHERE JOIN_DATE <= DATE_SUB(SYSDATE(), INTERVAL 10 YEAR);
